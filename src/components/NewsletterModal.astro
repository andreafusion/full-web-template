---
---

<div
  class="modal-overlay"
  id="newsletter-overlay"
  role="dialog"
  aria-modal="true"
  aria-labelledby="modal-title"
  hidden
>
  <div class="modal">
    <button class="modal__close" id="modal-close" aria-label="Cerrar ventana" type="button">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true">
        <line x1="1" y1="1" x2="15" y2="15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        <line x1="15" y1="1" x2="1" y2="15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>

    <h2 id="modal-title" class="modal__title">Iconic Duality</h2>
    <p class="modal__subtitle">Dos estilos. Una newsletter.</p>
    <p class="modal__desc">
      Cada mes recibirás inspiración sobre manicuras naturales, tendencias delicadas y
      ofertas exclusivas. Solo para las que aprecian lo bonito sin exagerar.
    </p>

    <form id="newsletter-form" novalidate>
      <div class="modal__field">
        <label for="newsletter-email" class="sr-only">Tu correo electrónico</label>
        <input
          type="email"
          id="newsletter-email"
          name="email"
          placeholder="Quiero enterarme de las promociones"
          required
          autocomplete="email"
        />
      </div>
      <button type="submit" class="btn btn--primary">Suscribirme</button>
      <p class="modal__legal">
        Al suscribirte, aceptas recibir emails con novedades y ofertas.
        Puedes darte de baja cuando quieras.
      </p>
    </form>

    <p class="modal__success" id="modal-success" hidden>¡Bienvenida! Revisa tu email.</p>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const overlay    = document.getElementById('newsletter-overlay') as HTMLElement | null;
    const closeBtn   = document.getElementById('modal-close')        as HTMLButtonElement | null;
    const form       = document.getElementById('newsletter-form')    as HTMLFormElement | null;
    const successMsg = document.getElementById('modal-success')      as HTMLElement | null;

    if (!overlay) return;

    function openModal() {
      overlay!.hidden = false;
      closeBtn?.focus();
    }

    function closeModal() {
      overlay!.hidden = true;
      try { sessionStorage.setItem('newsletter-dismissed', 'true'); } catch (_e) {}
    }

    let dismissed = false;
    try { dismissed = !!sessionStorage.getItem('newsletter-dismissed'); } catch (_e) {}
    if (!dismissed) {
      setTimeout(openModal, 8000);
    }

    closeBtn?.addEventListener('click', (e) => {
      e.stopPropagation();
      closeModal();
    });

    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) closeModal();
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !overlay.hidden) closeModal();
    });

    form?.addEventListener('submit', (e) => {
      e.preventDefault();
      if (form)       form.hidden = true;
      if (successMsg) successMsg.hidden = false;
      setTimeout(closeModal, 2500);
    });
  });
</script>
